{{ define "main" }}
  {{ $content := .Content }}
  {{ $main := replaceRE "(?s)<!-- PAGE_RIGHT_START -->(.*?)<!-- PAGE_RIGHT_END -->" "" $content }}
  <article>
	{{ $main | safeHTML }}
  </article>
{{ end }}


{{ define "sidebar" }}
  {{ $content := .Content }}
  {{ $right := "" }}
  {{ with findRE "(?s)<!-- PAGE_RIGHT_START -->(.*?)<!-- PAGE_RIGHT_END -->" $content }}
    {{ $right = index . 0 }}
    {{ $right = replaceRE "(?s)<!-- PAGE_RIGHT_START -->|<!-- PAGE_RIGHT_END -->" "" $right }}
  {{ end }}
  <aside class="page-right">
    {{ $right | safeHTML }}
  </aside>

  {{- /* フロントマターのtagsをバッジ表示 */}}
  {{- with .GetTerms "tags" }}
    <section class="widget page-meta">
      <h3>ラベル</h3>
      <ul class="tag-list">
        {{- range . }}
          <li><a href="{{ .RelPermalink }}" class="tag-badge">{{ .LinkTitle }}</a></li>
        {{- end }}
      </ul>
    </section>
  {{- end }}

  {{- /* フロントマターのfix_versionsをバッジ表示 */}}
  {{- with .GetTerms "fix_versions" }}
    <section class="widget page-meta">
      <h3>修正バージョン</h3>
      <ul class="tag-list">
        {{- range . }}
          <li><a href="{{ .RelPermalink }}" class="tag-badge">{{ .LinkTitle }}</a></li>
        {{- end }}
      </ul>
    </section>
  {{- end }}

  {{- /* フロントマターのaffected_versionsをバッジ表示 */}}
  {{- with .GetTerms "affected_versions" }}
    <section class="widget page-meta">
      <h3>影響バージョン</h3>
      <ul class="tag-list">
        {{- range . }}
          <li><a href="{{ .RelPermalink }}" class="tag-badge">{{ .LinkTitle }}</a></li>
        {{- end }}
      </ul>
    </section>
  {{- end }}
{{ end }}
